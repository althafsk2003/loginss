@{
    Layout = "~/Views/Shared/_ClubAdminLayout.cshtml";
    ViewBag.Title = "Club Admin Dashboard";
}

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Google Fonts: Nunito -->
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Font Awesome for Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    html, body {
        font-family: 'Nunito', sans-serif;
        margin: 0;
        padding: 15px;
        height: 100vh;
        color: #333;
        box-sizing: border-box;
        background: #f4f7fa;
        overflow: hidden;
    }

    .dashboard-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 10px;
        max-height: calc(100vh - 30px);
        display: flex;
        flex-direction: column;
    }

    .card {
        background: #fff;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        margin-bottom: 15px;
        transition: transform 0.2s;
    }

        .card:hover {
            transform: translateY(-5px);
        }

    .main-section {
        display: grid;
        grid-template-columns: 1fr 2fr 1fr; /* left, middle, right */
        gap: 15px;
        flex: 1;
        overflow-y: auto;
    }

    .left-section, .middle-section, .right-section {
        display: flex;
        flex-direction: column;
    }

    /* Profile */
    .profile-card {
        text-align: center;
    }

    .profile-img {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #4b5cc4;
        margin: 0 auto 15px;
    }

    .details-list {
        list-style: none;
        padding: 0;
        font-size: 14px;
        color: #555;
        margin: 20px 0;
    }

        .details-list li {
            margin-bottom: 8px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

    /* Stats */
    .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
        gap: 10px;
        margin: 8px 0;
    }

    .stat-card {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 10px;
        text-align: center;
        transition: background 0.3s;
    }

        .stat-card:hover {
            background: #e8e9ff;
        }

        .stat-card i {
            color: #7b61ff;
            font-size: 18px;
            margin-bottom: 3px;
        }

        .stat-card h5 {
            color: #4b5cc4;
            font-size: 12px;
            margin: 3px 0;
        }

        .stat-card p {
            font-size: 16px;
            font-weight: 700;
            color: #333;
        }

    /* Graph */
    .graph-card {
        padding: 15px;
        position: relative;
        overflow: hidden;
    }

        .graph-card h4 {
            font-size: 14px;
            margin-bottom: 6px;
        }

        .graph-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #7b61ff, #00f0ff);
            animation: gradientShift 3s linear infinite;
        }

    #eventsChart {
        max-height: 250px;
        width: 100%;
    }

    /* Notifications */
    .event-notification-card {
        max-height: 500px;
        overflow-y: auto;
    }

        .event-notification-card h4 {
            position: sticky;
            top: 0;
            background: #fff;
            padding: 10px 0;
            margin: 0 0 10px;
            border-bottom: 2px solid #eee;
            z-index: 1;
        }

        .event-notification-card .notification-item {
            padding: 10px;
            border-bottom: 1px solid #f1f1f1;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

            .event-notification-card .notification-item:last-child {
                border-bottom: none;
            }

            .event-notification-card .notification-item a {
                color: #7b61ff;
                font-weight: 600;
                font-size: 12px;
                text-decoration: none;
            }

                .event-notification-card .notification-item a:hover {
                    text-decoration: underline;
                }

    @@keyframes gradientShift {
        0% {
            transform: translateX(-100%);
        }

        100% {
            transform: translateX(100%);
        }
    }

    @@media (max-width: 992px) {
        .main-section {
            grid-template-columns: 1fr;
        }

        #eventsChart {
            max-height: 200px;
        }
    }
</style>

<!-- Main Content -->
<div class="dashboard-container">
    <div class="main-section">
        <!-- Left Section: Profile -->
        <div class="left-section">
            <div class="card profile-card">
                <h4 class="mb-3">Club Profile</h4>
                <div class="club-logo-container">
                    @if (!string.IsNullOrEmpty(ViewBag.ClubAdminPhoto))
                    {
                        <img src="@Url.Content(ViewBag.ClubAdminPhoto)" class="profile-img" alt="Club Logo" />
                    }
                    else
                    {
                        <i class="fas fa-user-circle" style="font-size:100px;color:#4b5cc4;"></i>
                        <p class="text-muted mt-2">No Club Logo Uploaded</p>
                    }
                </div>
                <ul class="details-list">
                    <li><i class="fas fa-home"></i> <strong>Club Name:</strong> @(ViewBag.ClubName ?? "N/A")</li>
                    <li>
                        <i class="fas fa-building"></i> <strong>Department:</strong>
                        @if (!string.IsNullOrEmpty(ViewBag.SubDepartment))
                        {
                            @($"{ViewBag.SubDepartment} (Sub) / {ViewBag.Department}")
                        }
                        else
                        { @ViewBag.Department}
                    </li>
                    <li><i class="fas fa-university"></i> <strong>University:</strong> @(ViewBag.University ?? "N/A")</li>
                </ul>
            </div>
        </div>

        <!-- Middle Section: Stats + Graph -->
        <div class="middle-section">
            <div class="card stats-card">
                <div class="stats-container">
                    <div class="stat-card">
                        <i class="fas fa-calendar-alt"></i>
                        <h5>Total Events</h5>
                        <p>@(ViewBag.NumberOfEvents ?? 0)</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-check-circle"></i>
                        <h5>Active Status</h5>
                        <p>@(ViewBag.ClubStatus ?? "Active")</p>
                    </div>
                </div>
            </div>
            <div class="card graph-card">
                <h4>Clubs and Events Overview</h4>
                <canvas id="eventsChart"></canvas>
            </div>
        </div>

        <!-- Right Section: Notifications -->
        @{
            var eventCards = ViewBag.EventCards as List<dynamic>;
        }

        <div class="card event-notification-card">
            <h4>Event Notifications</h4>
            @if (eventCards != null && eventCards.Count > 0)
            {
                foreach (var card in eventCards)
                {
                    <div class="notification-item">
                        <span>@card.Message</span>
                        @if (!string.IsNullOrEmpty(card.Url))
                        {
                            <a href="@card.Url">View</a>
                        }
                    </div>
                }
            }
            else
            {
                <div class="notification-item">No event notifications</div>
            }
        </div>

    </div>
</div>

<!-- Chart Script -->
<script>
    const ctx = document.getElementById('eventsChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Clubs', 'Events'],
            datasets: [{
                label: 'Count',
                data: [@(ViewBag.NumberOfClubs ?? 0), @(ViewBag.NumberOfEvents ?? 0)],
                backgroundColor: ['#7b61ff', '#00f0ff'],
                borderColor: ['#4b5cc4', '#00b8cc'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true } }
        }
    });
</script>
